{% extends 'base.html' %}
{% block content %}
<div class="d-flex justify-content-between align-items-center mb-4">
  <h3>ğŸ—ï¸ GestiÃ³n de Proyectos</h3>
  <div>
    <a class="btn btn-primary" href="{% url 'project_create' %}">â• Nuevo Proyecto</a>
    <a class="btn btn-outline-secondary" href="{% url 'activity_create' %}">ğŸ“‹ Nueva Actividad</a>
    <a class="btn btn-outline-info" href="{% url 'activity_log_create' %}">ğŸ“ Registrar Avance</a>
  </div>
</div>
{% for p in projects %}
  <div class="card my-3 shadow-sm">
    <div class="card-body">
      <h5 class="card-title">{{p.name}}</h5>
      <p class="card-text text-muted">{{p.description}}</p>
      <h6 class="mt-3">ğŸ“‹ Actividades del Proyecto</h6>
      <table class="table table-hover">
        <thead class="table-light">
          <tr>
            <th>ğŸ“ Actividad</th>
            <th>ğŸ“… Planificado</th>
            <th>ğŸ“Š Progreso</th>
            <th>ğŸ”„ Estado</th>
          </tr>
        </thead>
        <tbody>
          {% for a in p.activities.all %}
            <tr>
              <td>{{a.name}}</td>
              <td>{{a.planned_start|date:"d/m/Y"}} â†’ {{a.planned_end|date:"d/m/Y"}}</td>
              <td>
                <div class="progress" style="height: 20px;">
                  <div class="progress-bar bg-success" role="progressbar" style="width: {{a.progress_percent}}%" aria-valuenow="{{a.progress_percent}}" aria-valuemin="0" aria-valuemax="100">{{a.progress_percent}}%</div>
                </div>
              </td>
              <td>
                <span class="badge {% if a.status == 'completed' %}bg-success{% elif a.status == 'in_progress' %}bg-primary{% elif a.status == 'pending' %}bg-warning{% else %}bg-secondary{% endif %}">
                  {{a.get_status_display}}
                </span>
              </td>
            </tr>
          {% empty %}
            <tr>
              <td colspan="4" class="text-center text-muted">No hay actividades en este proyecto</td>
            </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
  </div>
{% empty %}
  <div class="text-center mt-5">
    <h4 class="text-muted">ğŸ—ï¸ No hay proyectos registrados</h4>
    <p class="text-muted">Comienza creando tu primer proyecto para gestionar tus actividades de construcciÃ³n.</p>
  </div>
{% endfor %}
{% endblock %}
